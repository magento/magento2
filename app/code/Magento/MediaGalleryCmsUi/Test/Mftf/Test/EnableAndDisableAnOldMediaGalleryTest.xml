<?xml version="1.0" encoding="UTF-8"?>
<!--
 /**
  * Copyright Â© Magento, Inc. All rights reserved.
  * See COPYING.txt for license details.
  */
-->

<tests xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
       xsi:noNamespaceSchemaLocation="urn:magento:mftf:Test/etc/testSchema.xsd">
    <test name="EnableAndDisableAnOldMediaGalleryTest">
        <annotations>
            <stories value="Create a CMS Page via the Admin"/>
            <title value="Enable and disable an old media gallery and validate the admin Content menu has no impact"/>
            <description value="Enable and disable an old media gallery and validate the admin Content menu has no impact"/>
            <severity value="MAJOR"/>
            <testCaseId value="AC-5553"/>
        </annotations>
        <before>
            <actionGroup ref="AdminLoginActionGroup" stepKey="loginGetFromGeneralFile"/>
        </before>
        <after>
            <actionGroup ref="AdminMediaGalleryEnhancedEnableActionGroup" stepKey="disableOldMediaGalleryAfterEnabled">
                <argument name="enabled" value="1"/>
            </actionGroup>
            <actionGroup ref="CliIndexerReindexActionGroup" stepKey="reindex">
                <argument name="indices" value=""/>
            </actionGroup>
            <actionGroup ref="CliCacheFlushActionGroup" stepKey="flushCache">
                <argument name="tags" value=""/>
            </actionGroup>
            <actionGroup ref="AdminLogoutActionGroup" stepKey="adminLogout"/>
        </after>
        <!-- Disable media Gallery-->
        <actionGroup ref="AdminMediaGalleryEnhancedEnableActionGroup" stepKey="disableOldMediaGallery">
            <argument name="enabled" value="1"/>
        </actionGroup>
        <see selector="{{AdminMessagesSection.success}}" userInput="You saved the configuration." stepKey="seeConfigurationSuccessMessageAfterDisabled"/>
        <actionGroup ref="CliIndexerReindexActionGroup" stepKey="reindexAfterDisabledMediaGallery">
            <argument name="indices" value=""/>
        </actionGroup>
        <actionGroup ref="CliCacheFlushActionGroup" stepKey="flushCacheAfterDisabledMediaGallery">
            <argument name="tags" value=""/>
        </actionGroup>
        <reloadPage stepKey="refreshPageToLoadContent"/>
        <waitForPageLoad stepKey="waitTillContentPageLoad"/>
        <!-- Go to content page and validate-->
        <click selector="{{CmsNewPageSection.content}}" stepKey="clickOnContentIcon"/>
        <waitForPageLoad stepKey="waitForSystemsPageToOpen"/>
        <seeElement selector="{{CmsNewPageHierarchySection.selectHierarchy('Pages')}}" stepKey="assertPages"/>
        <seeElement selector="{{CmsNewPageHierarchySection.selectHierarchy('Hierarchy')}}" stepKey="assertHierarchy"/>
        <seeElement selector="{{CmsNewPageHierarchySection.selectHierarchy('Blocks')}}" stepKey="assertBlocks"/>
        <seeElement selector="{{CmsNewPageHierarchySection.selectHierarchy('Dynamic Blocks')}}" stepKey="assertDynamicBlocks"/>
        <seeElement selector="{{CmsNewPageHierarchySection.selectHierarchy('Widgets')}}" stepKey="assertWidgets"/>
        <seeElement selector="{{CmsNewPageHierarchySection.selectHierarchy('Templates')}}" stepKey="assertTemplates"/>
        <seeElement selector="{{CmsNewPageHierarchySection.selectHierarchy('Media Gallery')}}" stepKey="assertMediaGallery"/>
        <seeElement selector="{{CmsNewPageHierarchySection.selectHierarchy('Configuration')}}" stepKey="assertConfiguration"/>
        <seeElement selector="{{CmsNewPageHierarchySection.selectHierarchy('Themes')}}" stepKey="assertThemes"/>
        <seeElement selector="{{CmsNewPageHierarchySection.selectHierarchy('Schedule')}}" stepKey="assertSchedule"/>
        <seeElement selector="{{CmsNewPageHierarchySection.selectHierarchy('Dashboard')}}" stepKey="assertDashBoard"/>
        <!-- Enable media Gallery-->
        <actionGroup ref="AdminMediaGalleryEnhancedEnableActionGroup" stepKey="enableOldMediaGallery">
            <argument name="enabled" value="0"/>
        </actionGroup>
        <see selector="{{AdminMessagesSection.success}}" userInput="You saved the configuration." stepKey="seeConfigurationSuccessMessage"/>
        <actionGroup ref="CliIndexerReindexActionGroup" stepKey="reindexAfterEnabledMediaGallery">
            <argument name="indices" value=""/>
        </actionGroup>
        <actionGroup ref="CliCacheFlushActionGroup" stepKey="flushCacheAfterEnabledMediaGallery">
            <argument name="tags" value=""/>
        </actionGroup>
        <reloadPage stepKey="refreshPageToLoadContentAfterEnabled"/>
        <waitForPageLoad stepKey="waitTillContentPageLoadAfterEnabled"/>
        <!-- Go to content page and validate-->
        <click selector="{{CmsNewPageSection.content}}" stepKey="clickOnContentIcon2"/>
        <waitForPageLoad stepKey="waitForSystemsPageToOpenAgain"/>
        <seeElement selector="{{CmsNewPageHierarchySection.selectHierarchy('Pages')}}" stepKey="assertPages2"/>
        <seeElement selector="{{CmsNewPageHierarchySection.selectHierarchy('Hierarchy')}}" stepKey="assertHierarchy2"/>
        <seeElement selector="{{CmsNewPageHierarchySection.selectHierarchy('Blocks')}}" stepKey="assertBlocks2"/>
        <seeElement selector="{{CmsNewPageHierarchySection.selectHierarchy('Dynamic Blocks')}}" stepKey="assertDynamicBlocks2"/>
        <seeElement selector="{{CmsNewPageHierarchySection.selectHierarchy('Widgets')}}" stepKey="assertWidgets2"/>
        <seeElement selector="{{CmsNewPageHierarchySection.selectHierarchy('Templates')}}" stepKey="assertTemplates2"/>
        <seeElement selector="{{CmsNewPageHierarchySection.selectHierarchy('Configuration')}}" stepKey="assertConfiguration2"/>
        <seeElement selector="{{CmsNewPageHierarchySection.selectHierarchy('Themes')}}" stepKey="assertThemes2"/>
        <seeElement selector="{{CmsNewPageHierarchySection.selectHierarchy('Schedule')}}" stepKey="assertSchedule2"/>
        <seeElement selector="{{CmsNewPageHierarchySection.selectHierarchy('Dashboard')}}" stepKey="assertDashBoard2"/>
    </test>
</tests>
