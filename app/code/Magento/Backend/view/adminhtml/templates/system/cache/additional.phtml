<?php
/**
 * Copyright Â© Magento, Inc. All rights reserved.
 * See COPYING.txt for license details.
 */
declare(strict_types=1);

use Magento\Backend\Block\Cache\Permissions;
use Magento\Framework\Escaper;
use Magento\Framework\View\Helper\SecureHtmlRenderer;

/** @var Escaper $escaper */
/** @var Permissions|null $permissions */
/** @var SecureHtmlRenderer $secureRenderer */

$permissions = $block->getData('permissions');
?>
<?php if ($permissions && $permissions->hasAccessToAdditionalActions()): ?>
    <div class="additional-cache-management">
        <h2>
            <span><?= $escaper->escapeHtml(__('Additional Cache Management')); ?></span>
        </h2>
        <?php if ($permissions->hasAccessToFlushCatalogImages()): ?>
            <p>
                <button id="flushCatalogImages" type="button">
                    <?= $escaper->escapeHtml(__('Flush Catalog Images Cache')); ?>
                </button>
                <?= /* @noEscape */ $secureRenderer->renderEventListenerAsTag(
                    'onclick',
                    'setLocation(\'' . $escaper->escapeJs($block->getCleanImagesUrl()) . '\')',
                    'button#flushCatalogImages'
                ) ?>
                <span><?= $escaper->escapeHtml(__('Pregenerated product images files')); ?></span>
            </p>
        <?php endif; ?>
        <?php if ($permissions->hasAccessToFlushJsCss()): ?>
            <p>
                <button id="flushJsCss" type="button">
                    <?= $escaper->escapeHtml(__('Flush JavaScript/CSS Cache')); ?>
                </button>
                <?= /* @noEscape */ $secureRenderer->renderEventListenerAsTag(
                    'onclick',
                    'setLocation(\'' . $escaper->escapeJs($block->getCleanMediaUrl()) . '\')',
                    'button#flushJsCss'
                ) ?>
                <span><?= $escaper->escapeHtml(__('Themes JavaScript and CSS files combined to one file')) ?></span>
            </p>
        <?php endif; ?>
        <?php if (!$block->isInProductionMode() && $permissions->hasAccessToFlushStaticFiles()): ?>
            <p>
                <button id="flushStaticFiles" type="button">
                    <?= $escaper->escapeHtml(__('Flush Static Files Cache')); ?>
                </button>
                <?= /* @noEscape */ $secureRenderer->renderEventListenerAsTag(
                    'onclick',
                    'setLocation(\'' . $escaper->escapeJs($block->getCleanStaticFilesUrl()) . '\')',
                    'button#flushStaticFiles'
                ) ?>
                <span><?= $escaper->escapeHtml(__('Preprocessed view files and static files')); ?></span>
            </p>
        <?php endif; ?>
        <?= $block->getChildHtml() ?>
    </div>
<?php endif; ?>
