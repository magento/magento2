<?php
/**
 * Copyright Â© Magento, Inc. All rights reserved.
 * See COPYING.txt for license details.
 */

/** @var \Magento\Framework\View\Helper\SecureHtmlRenderer $secureRenderer */
?>
<div id="product_composite_configure" class="product-configure-popup">
    <iframe name="product_composite_configure_iframe" id="product_composite_configure_iframe"></iframe>
    <?= /* @noEscape */ $secureRenderer->renderEventListenerAsTag(
        'onload',
        "window.productConfigure && productConfigure.onLoadIFrame()",
        'iframe[name=\'product_composite_configure_iframe\']:last-of-type'
    ) ?>
    <?= /* @noEscape */ $secureRenderer->renderStyleAsTag(
        "width:0; height:0; border:0px solid #fff; position:absolute; top:-1000px; left:-1000px",
        'iframe[name=\'product_composite_configure_iframe\']:last-of-type'
    ) ?>

    <form action="" method="post" id="product_composite_configure_form" enctype="multipart/form-data"
          target="product_composite_configure_iframe" class="product_composite_configure_form">
        <div class="entry-edit">
            <div id="product_composite_configure_messages" class="product_composite_configure_messages">
                <div class="messages"><div class="message message-error error"><div></div></div></div>
            </div>
            <?= /* @noEscape */ $secureRenderer->renderStyleAsTag(
                'display:none;',
                '.product_composite_configure_messages:last-of-type'
            ) ?>
            <div id="product_composite_configure_form_fields" class="content product-composite-configure-inner"></div>
            <div id="product_composite_configure_form_additional" class="product_composite_configure_form_additional">
            </div>
            <?= /* @noEscape */ $secureRenderer->renderStyleAsTag(
                'display:none;',
                '.product_composite_configure_form_additional:last-of-type'
            ) ?>
            <div id="product_composite_configure_form_confirmed" class="product_composite_configure_form_confirmed"></div>
            <?= /* @noEscape */ $secureRenderer->renderStyleAsTag(
                'display:none;',
                '.product_composite_configure_form_confirmed:last-of-type'
            ) ?>
        </div>
        <input type="hidden" name="as_js_varname" value="iFrameResponse" />
        <input type="hidden" name="form_key" value="<?= $block->escapeHtmlAttr($block->getFormKey()) ?>" />
    </form>
    <?= /* @noEscape */ $secureRenderer->renderEventListenerAsTag(
        'onsubmit',
        "productConfigure.onConfirmBtn();event.preventDefault()",
        '.product_composite_configure_form:last-of-type'
    ) ?>

    <div id="product_composite_configure_confirmed" class="product_composite_configure_confirmed"></div>
    <?= /* @noEscape */ $secureRenderer->renderStyleAsTag(
        'display:none;',
        '.product_composite_configure_confirmed:last-of-type'
    ) ?>

    <?php $scriptString = <<<script
        require([
            "jquery",
            "mage/mage"
        ], function(jQuery){
            jQuery('.product_composite_configure_form').each(function () {
                jQuery(this).mage('form').mage('validation');
            });
        });
script;
    ?>
    <?= /* @noEscape */ $secureRenderer->renderTag('script', [], $scriptString, false); ?>
</div>
<?= /* @noEscape */ $secureRenderer->renderStyleAsTag(
    'display:none',
    '.product-configure-popup:last-of-type'
) ?>

