<?php
/**
 * Copyright Â© 2013-2017 Magento, Inc. All rights reserved.
 * See COPYING.txt for license details.
 */

// @codingStandardsIgnoreFile
?>
<?php /** @var $block Magento\Signifyd\Block\Adminhtml\CaseInfo */ ?>
<?php
    if (!$block->isModuleActive() || !($case = $block->getCaseEntity())) {
        return '';
    }
?>
<section class="admin__page-section order-case-info">
    <div class="admin__page-section-title">
        <span class="title"><?php /* @escapeNotVerified */ echo __('Fraud Protection Information') ?></span>
    </div>
    <div class="admin__table-wrapper">
        <table class="data-table admin__table-primary order-case-table">
            <thead>
            <tr class="headings">
                <th class="col-case-status"><?php /* @escapeNotVerified */ echo __('Case Status'); ?></th>
                <th class="col-case-score"><?php /* @escapeNotVerified */ echo __('Case Score'); ?></th>
                <th class="col-guarantee-eligible"><?php /* @escapeNotVerified */ echo __('Guarantee eligible'); ?></th>
                <th class="col-guarantee-disposition"><?php /* @escapeNotVerified */ echo __('Guarantee disposition'); ?></th>
                <th class="col-case-team"><?php /* @escapeNotVerified */ echo __('Associated team'); ?></th>
                <th class="col-case-review"><?php /* @escapeNotVerified */ echo __('Review disposition'); ?></th>
                <th class="col-case-created"><?php /* @escapeNotVerified */ echo __('Case Created'); ?></th>
                <th class="col-case-updated"><?php /* @escapeNotVerified */ echo __('Case Updated'); ?></th>
            </tr>
            </thead>
            <tbody class="even">
            <tr>
                <td class="col-case-status"><?php echo $block->escapeHtml($case->getStatus()); ?></td>
                <td class="col-case-score-<?php echo $block->escapeHtml($block->getScoreClass($case)); ?>"><?php echo $block->escapeHtml($case->getScore()); ?></td>
                <td class="col-guarantee-eligible"><?php echo $block->escapeHtml($block->getGuaranteeEligible($case)); ?></td>
                <td class="col-guarantee-disposition"><?php echo $block->escapeHtml($case->getGuaranteeDisposition()); ?></td>
                <td class="col-case-team"><?php echo $block->escapeHtml($block->getAssociatedTeam($case)); ?></td>
                <td class="col-case-review"><?php echo $block->escapeHtml($case->getReviewDisposition()); ?></td>
                <td class="col-case-created"><?php echo $block->escapeHtml($case->getCreatedAt()); ?></td>
                <td class="col-case-updated"><?php echo $block->escapeHtml($case->getUpdatedAt()); ?></td>
            </tr>
            </tbody>
        </table>

        <?php foreach ($block->getButtons() as $button):?>
        <div data-bind="scope: '<?php /* @escapeNotVerified */ echo $button['componentName']; ?>'">
            <!-- ko template: getTemplate() --><!-- /ko -->
            <script type="text/x-magento-init">
            {
                "*":{
                    "Magento_Ui/js/core/app": {
                        "components": {
                            "<?php /* @escapeNotVerified */ echo $button['componentName']; ?>": {
                                "component": "Magento_Signifyd/js/request-send",
                                "config": {
                                    "title": "<?php echo $block->escapeHtml($button['title']); ?>",
                                    "requestURL": "<?php /* @escapeNotVerified */ echo $button['url']; ?>",
                                    "data": {
                                        "orderId": "<?php /* @escapeNotVerified */ echo $button['orderId']; ?>"
                                    },
                                    "actions": [
                                        {
                                            "targetName": "${ $.name }",
                                            "actionName": "sendRequest"
                                        }
                                    ]
                                }
                            }
                        }
                    }
                }
            }
            </script>
        </div>
        <?php endforeach; ?>
    </div>
</section>
