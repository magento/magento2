<?php
/**
 * Copyright Â© 2013-2017 Magento, Inc. All rights reserved.
 * See COPYING.txt for license details.
 */

// @codingStandardsIgnoreFile
?>
<?php /** @var $block Magento\Signifyd\Block\Adminhtml\CaseInfo */ ?>
<?php

    if (!$block->isServiceActive() || $block->isEmptyCase()) {
        return '';
    }
?>
<section class="admin__page-section order-case-info">
    <div class="admin__page-section-title">
        <span class="title"><?php echo $block->escapeHtml(__('Fraud Protection Information')); ?></span>
    </div>
    <div class="admin__table-wrapper">
        <table class="data-table admin__table-primary order-case-table">
            <thead>
            <tr class="headings">
                <th class="col-case-status"><?php echo $block->escapeHtml(__('Case Status')); ?></th>
                <th class="col-case-score"><?php echo $block->escapeHtml(__('Case Score')); ?></th>
                <th class="col-guarantee-eligible"><?php echo $block->escapeHtml(__('Guarantee Eligible')); ?></th>
                <th class="col-guarantee-disposition"><?php echo $block->escapeHtml(__('Guarantee Disposition')); ?></th>
                <th class="col-case-team"><?php echo $block->escapeHtml(__('Associated Team')); ?></th>
                <th class="col-case-review"><?php echo $block->escapeHtml(__('Review Disposition')); ?></th>
                <th class="col-case-created"><?php echo $block->escapeHtml(__('Case Created')); ?></th>
                <th class="col-case-updated"><?php echo $block->escapeHtml(__('Case Updated')); ?></th>
            </tr>
            </thead>
            <tbody class="even">
            <tr>
                <td class="col-case-status"><?php echo $block->escapeHtml($block->getCaseStatus()); ?></td>
                <td class="col-case-score-<?php echo $block->escapeHtml($block->getScoreClass()); ?>"><?php echo $block->escapeHtml($block->getCaseScore()); ?></td>
                <td class="col-guarantee-eligible"><?php echo $block->escapeHtml($block->getCaseGuaranteeEligible()); ?></td>
                <td class="col-guarantee-disposition"><?php echo $block->escapeHtml($block->getCaseGuaranteeDisposition()); ?></td>
                <td class="col-case-team"><?php echo $block->escapeHtml($block->getCaseAssociatedTeam()); ?></td>
                <td class="col-case-review"><?php echo $block->escapeHtml($block->getCaseReviewDisposition()); ?></td>
                <td class="col-case-created"><?php echo $block->escapeHtml($block->getCaseCreatedAt()); ?></td>
                <td class="col-case-updated"><?php echo $block->escapeHtml($block->getCaseUpdatedAt()); ?></td>
            </tr>
            </tbody>
        </table>

        <?php foreach ($block->getButtons() as $button):?>
        <div data-bind="scope: '<?php echo $block->escapeHtml($button['componentName']); ?>'">
            <!-- ko template: getTemplate() --><!-- /ko -->
            <script type="text/x-magento-init">
            {
                "*":{
                    "Magento_Ui/js/core/app": {
                        "components": {
                            "<?php echo $block->escapeHtml($button['componentName']); ?>": {
                                "component": "Magento_Signifyd/js/request-send",
                                "config": {
                                    "title": "<?php echo $block->escapeHtml($button['title']); ?>",
                                    "requestURL": "<?php echo $block->escapeUrl($button['url']); ?>",
                                    "data": {
                                        "order_id": "<?php echo $block->escapeHtml($button['orderId']); ?>"
                                    },
                                    "actions": [
                                        {
                                            "targetName": "${ $.name }",
                                            "actionName": "sendRequest"
                                        }
                                    ]
                                }
                            }
                        }
                    }
                }
            }
            </script>
        </div>
        <?php endforeach; ?>
    </div>
</section>
